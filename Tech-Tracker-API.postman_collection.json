{
  "info": {
    "_postman_id": "tech-tracker-api-collection-v2",
    "name": "Tech Tracker API - With Auth",
    "description": "Complete API with JWT Authentication - Admin and Technician login with Bearer tokens",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "auth": {
    "type": "bearer",
    "bearer": [
      {
        "key": "token",
        "value": "{{auth_token}}",
        "type": "string"
      }
    ]
  },
  "item": [
    {
      "name": "üîê Authentication",
      "item": [
        {
          "name": "Admin Register",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    var jsonData = pm.response.json();",
                  "    pm.collectionVariables.set('admin_id', jsonData.admin.id);",
                  "    pm.collectionVariables.set('admin_token', jsonData.token);",
                  "    pm.collectionVariables.set('auth_token', jsonData.token);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Super Admin\",\n  \"email\": \"superadmin@test.com\",\n  \"password\": \"admin123\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/admin/register",
              "host": ["{{base_url}}"],
              "path": ["api", "admin", "register"]
            },
            "description": "Register a new admin and get JWT token"
          }
        },
        {
          "name": "Admin Login",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    var jsonData = pm.response.json();",
                  "    pm.collectionVariables.set('admin_id', jsonData.admin.id);",
                  "    pm.collectionVariables.set('admin_token', jsonData.token);",
                  "    pm.collectionVariables.set('auth_token', jsonData.token);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"superadmin@test.com\",\n  \"password\": \"admin123\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/admin/login",
              "host": ["{{base_url}}"],
              "path": ["api", "admin", "login"]
            },
            "description": "Login as admin and get JWT token (saves to auth_token)"
          }
        },
        {
          "name": "Technician Register",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    var jsonData = pm.response.json();",
                  "    pm.collectionVariables.set('tech_id', jsonData.technician.id);",
                  "    pm.collectionVariables.set('tech_token', jsonData.token);",
                  "    pm.collectionVariables.set('auth_token', jsonData.token);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"New Tech\",\n  \"email\": \"newtech@test.com\",\n  \"password\": \"tech123\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/technician/register",
              "host": ["{{base_url}}"],
              "path": ["api", "technician", "register"]
            },
            "description": "Register a new technician and get JWT token"
          }
        },
        {
          "name": "Technician Login",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    var jsonData = pm.response.json();",
                  "    pm.collectionVariables.set('tech_id', jsonData.technician.id);",
                  "    pm.collectionVariables.set('tech_token', jsonData.token);",
                  "    pm.collectionVariables.set('auth_token', jsonData.token);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"newtech@test.com\",\n  \"password\": \"tech123\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/technician/login",
              "host": ["{{base_url}}"],
              "path": ["api", "technician", "login"]
            },
            "description": "Login as technician and get JWT token (saves to auth_token)"
          }
        }
      ]
    },
    {
      "name": "üë®‚Äçüíº Admin Protected",
      "item": [
        {
          "name": "Create Admin (Admin Only)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Second Admin\",\n  \"email\": \"admin2@test.com\",\n  \"password\": \"admin123\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/admin/create-admin",
              "host": ["{{base_url}}"],
              "path": ["api", "admin", "create-admin"]
            },
            "description": "Admin creates another admin (requires admin token)"
          }
        },
        {
          "name": "Create Technician (Admin Only)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"New Technician\",\n  \"email\": \"tech2@test.com\",\n  \"password\": \"tech123\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/admin/create-technician",
              "host": ["{{base_url}}"],
              "path": ["api", "admin", "create-technician"]
            },
            "description": "Admin creates a technician (requires admin token)"
          }
        },
        {
          "name": "Assign Job to Technician",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    var jsonData = pm.response.json();",
                  "    pm.collectionVariables.set('job_id', jsonData.job.id);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"Fix Network Issue\",\n  \"description\": \"Router not working properly\",\n  \"address\": \"123 Main St, New York, NY 10001\",\n  \"adminId\": \"{{admin_id}}\",\n  \"techId\": \"{{tech_id}}\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/admin/assign-job",
              "host": ["{{base_url}}"],
              "path": ["api", "admin", "assign-job"]
            },
            "description": "Admin assigns job to technician (requires admin token)"
          }
        },
        {
          "name": "Get All Admins",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/admin/all",
              "host": ["{{base_url}}"],
              "path": ["api", "admin", "all"]
            },
            "description": "Get all admins (requires admin token)"
          }
        },
        {
          "name": "Get All Jobs",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/jobs",
              "host": ["{{base_url}}"],
              "path": ["api", "jobs"]
            },
            "description": "Get all jobs (requires any valid token)"
          }
        },
        {
          "name": "Get Job by ID",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/jobs/{{job_id}}",
              "host": ["{{base_url}}"],
              "path": ["api", "jobs", "{{job_id}}"]
            },
            "description": "Get specific job (requires any valid token)"
          }
        }
      ]
    },
    {
      "name": "üë∑ Technician Protected",
      "item": [
        {
          "name": "Get All Technicians",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/technician/all",
              "host": ["{{base_url}}"],
              "path": ["api", "technician", "all"]
            },
            "description": "Get all technicians (requires any valid token)"
          }
        },
        {
          "name": "Get Technician by ID",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/technician/{{tech_id}}",
              "host": ["{{base_url}}"],
              "path": ["api", "technician", "{{tech_id}}"]
            },
            "description": "Get technician details (requires any valid token)"
          }
        },
        {
          "name": "Get Technician Jobs",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/technician/{{tech_id}}/jobs",
              "host": ["{{base_url}}"],
              "path": ["api", "technician", "{{tech_id}}", "jobs"]
            },
            "description": "Get technician's assigned jobs (requires any valid token)"
          }
        },
        {
          "name": "Accept Job",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/jobs/{{job_id}}/accept",
              "host": ["{{base_url}}"],
              "path": ["api", "jobs", "{{job_id}}", "accept"]
            },
            "description": "Technician accepts job (requires technician token)"
          }
        },
        {
          "name": "Start Job (Enable Tracking)",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"techId\": \"{{tech_id}}\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/jobs/{{job_id}}/start",
              "host": ["{{base_url}}"],
              "path": ["api", "jobs", "{{job_id}}", "start"]
            },
            "description": "Start job and enable tracking (requires technician token)"
          }
        },
        {
          "name": "Complete Job (Disable Tracking)",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"techId\": \"{{tech_id}}\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/jobs/{{job_id}}/complete",
              "host": ["{{base_url}}"],
              "path": ["api", "jobs", "{{job_id}}", "complete"]
            },
            "description": "Complete job and disable tracking (requires technician token)"
          }
        },
        {
          "name": "Toggle Location Tracking",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"isTracking\": true\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/technician/{{tech_id}}/toggle-tracking",
              "host": ["{{base_url}}"],
              "path": ["api", "technician", "{{tech_id}}", "toggle-tracking"]
            },
            "description": "Toggle tracking on/off (requires technician token)"
          }
        },
        {
          "name": "Get Location History",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/technician/{{tech_id}}/location-history",
              "host": ["{{base_url}}"],
              "path": ["api", "technician", "{{tech_id}}", "location-history"]
            },
            "description": "Get location history (requires any valid token)"
          }
        }
      ]
    },
    {
      "name": "Health Check",
      "request": {
        "auth": {
          "type": "noauth"
        },
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{base_url}}/health",
          "host": ["{{base_url}}"],
          "path": ["health"]
        },
        "description": "Public health check endpoint"
      }
    }
  ],
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:3000",
      "type": "string"
    },
    {
      "key": "admin_id",
      "value": "d87c5789-8d58-4a31-b9b3-b20d82ab267b",
      "type": "string"
    },
    {
      "key": "tech_id",
      "value": "e3d9e9db-7d44-4321-b9ff-12a10805eb87",
      "type": "string"
    },
    {
      "key": "job_id",
      "value": "",
      "type": "string"
    },
    {
      "key": "auth_token",
      "value": "",
      "type": "string"
    },
    {
      "key": "admin_token",
      "value": "",
      "type": "string"
    },
    {
      "key": "tech_token",
      "value": "",
      "type": "string"
    }
  ]
}
